`10` = "Video 10",
`11` = "Video 11",
`12` = "Video 12",
`13` = "Video 13",
`14` = "Video 14",
`15` = "Video 15",
`16` = "Video 16",
`17` = "Video 17",
`18` = "Video 18",
`19` = "Video 19",
`20` = "Video 20",
`21` = "Video 21",
`22` = "Video 22",
`23` = "Video 23",
`24` = "Video 24")
SubjData = AllData %>%
group_by(Subj,Group,Video) %>%
dplyr::summarise(ChangeRecode = mean(ChangeRecode))
GroupData = SubjData %>%
group_by(Group,Video) %>%
dplyr::summarise(meanChangeRecode = mean(ChangeRecode), SE = sem(ChangeRecode))
SubjData$Group = factor(SubjData$Group,levels= c("Liberal", "Conservative"))
GroupData$Group = factor(GroupData$Group, levels= c("Liberal", "Conservative"))
t_shift <- scales::trans_new("shift",
transform = function(x) {x-1},
inverse = function(x) {x+1})
ggplot(SubjData, aes(x = Group, y = ChangeRecode, color = Group)) +
geom_bar(aes(x = Group, y = meanChangeRecode),
data = GroupData,
stat = "identity",
fill="white",
width = 0.25,
size = 1) +
geom_errorbar(aes(x = Group, y = NULL, ymin = meanChangeRecode-SE, ymax = meanChangeRecode+SE, color = Group),
data = GroupData,
width = 0.2) +
geom_jitter(width = 0.05, height = 0, alpha = 0.3) +
scale_y_continuous(breaks = c(1, 2, 3, 4, 5), trans = t_shift) +
theme(legend.position="none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text.x  = element_text(size=12,color="black"),
axis.text.y  = element_text(size=12,color="black"),
axis.title.x = element_blank(),
axis.title.y = element_text(size=14),
title = element_text(size=16),
strip.text.x = element_text(size = 12)) +
coord_cartesian(ylim = c(1,5)) +
scale_color_manual(values = myPalette) +
facet_wrap(~ Video, ncol = 4)
summary(lmer(ChangeRecode ~ Con_Lib + ImmScore + (1|Subj) + (1|Video), data = AllData))
summary(lmer(AgreeRecode ~ Con_Lib + ImmScore + (1|Subj) + (1|Video), data = AllData))
summary(lmer(CredRecode ~ Con_Lib + ImmScore + (1|Subj) + (1|Video), data = AllData))
rm(list=ls())
library(plyr)
library(dplyr)
library(tidyverse)
# inputFile = 'WB_regional.csv';
# outputFile = '../data/fmri/movie_data/wb_roi/WB_regional.csv';
# SubjKey = 'SubjKey.csv'
#
# dKey = read.csv(SubjKey)
# colnames(dKey) = c('Subject','SubjNo')
# d0 = read.csv(inputFile)
#
# dOutput = right_join(dKey,d0) %>%
#   select(-Subject)
#
# colnames(dOutput)[1] = 'Subject'
#
# dOutput = dOutput[order(dOutput$roi,dOutput$Subject),]
#
# write.csv(dOutput,file = outputFile, row.names = F)
# inputFile = 'AllData.csv';
# outputFile = '../data/behav/VideoRating.csv';
# SubjKey = 'SubjKey.csv'
# ImmScore = 'dDemo.tsv'
#
# dKey = read.csv(SubjKey)
# colnames(dKey) = c('Subj','SubjNo')
#
# d0 = read.csv(inputFile)
#
# dDemo = read.csv(ImmScore,sep = '')
# colnames(dDemo)[1] = 'Subj'
#
# dOutput = right_join(dKey,d0) %>%
#   right_join(dDemo)
#
# dOutput$Group = ifelse(dOutput$ImmScore > median(dOutput$ImmScore),'Conservative','Liberal')
#
# dOutput = dplyr::select(dOutput,
#                  c('SubjNo','Issue','Video','ReverseCode_Issue','ReverseCode_Video','Agree','Credible','Change','ImmScore','Group'))
#
# colnames(dOutput)[1] = 'Subj'
#
# dOutput = dOutput[order(dOutput$Subj),]
#
# write.csv(dOutput,file = outputFile, row.names = F)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
d0 = read.csv(inputFile)
View(d0)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('SubjNo','Subj')
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile)
View(d0)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile)
colnames(d0)[1] = 'Subj'
View(d0)
View(dKey)
View(d0)
View(dKey)
View(d0)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dDemo = read.csv(ImmScore,sep = '')
colnames(dDemo)[1] = 'Subj'
View(d0)
View(dDemo)
View(dKey)
dOutput = right_join(dKey,d0) %>%
right_join(dDemo)
View(dOutput)
dOutput$Group = ifelse(dOutput$ImmScore > median(dOutput$ImmScore),'Conservative','Liberal')
View(dOutput)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
dOutput = dplyr::select(dOutput,
-c('SubjNo'))
colnames(dOutput)[1] = 'Subj'
dOutput = dOutput[order(dOutput$Subj),]
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
dOutput = dplyr::select(dOutput,
-c('SubjNo'))
colnames(dOutput)[1] = 'Subj'
dOutput = dOutput[order(dOutput$Subj),]
write.csv(dOutput,file = outputFile, row.names = F, col.names = F)
rm(list=ls())
library(plyr)
library(dplyr)
library(tidyverse)
# inputFile = 'WB_regional.csv';
# outputFile = '../data/fmri/movie_data/wb_roi/WB_regional.csv';
# SubjKey = 'SubjKey.csv'
#
# dKey = read.csv(SubjKey)
# colnames(dKey) = c('Subject','SubjNo')
# d0 = read.csv(inputFile)
#
# dOutput = right_join(dKey,d0) %>%
#   select(-Subject)
#
# colnames(dOutput)[1] = 'Subject'
#
# dOutput = dOutput[order(dOutput$roi,dOutput$Subject),]
#
# write.csv(dOutput,file = outputFile, row.names = F)
# inputFile = 'AllData.csv';
# outputFile = '../data/behav/VideoRating.csv';
# SubjKey = 'SubjKey.csv'
# ImmScore = 'dDemo.tsv'
#
# dKey = read.csv(SubjKey)
# colnames(dKey) = c('Subj','SubjNo')
#
# d0 = read.csv(inputFile)
#
# dDemo = read.csv(ImmScore,sep = '')
# colnames(dDemo)[1] = 'Subj'
#
# dOutput = right_join(dKey,d0) %>%
#   right_join(dDemo)
#
# dOutput$Group = ifelse(dOutput$ImmScore > median(dOutput$ImmScore),'Conservative','Liberal')
#
# dOutput = dplyr::select(dOutput,
#                  c('SubjNo','Issue','Video','ReverseCode_Issue','ReverseCode_Video','Agree','Credible','Change','ImmScore','Group'))
#
# colnames(dOutput)[1] = 'Subj'
#
# dOutput = dOutput[order(dOutput$Subj),]
#
# write.csv(dOutput,file = outputFile, row.names = F)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
dOutput = dplyr::select(dOutput,
-c('SubjNo'))
colnames(dOutput)[1] = 'Subj'
dOutput = dOutput[order(dOutput$Subj),]
write.csv(dOutput,file = outputFile, row.names = F, col.names = F)
rm(list=ls())
library(plyr)
library(dplyr)
library(tidyverse)
# inputFile = 'WB_regional.csv';
# outputFile = '../data/fmri/movie_data/wb_roi/WB_regional.csv';
# SubjKey = 'SubjKey.csv'
#
# dKey = read.csv(SubjKey)
# colnames(dKey) = c('Subject','SubjNo')
# d0 = read.csv(inputFile)
#
# dOutput = right_join(dKey,d0) %>%
#   select(-Subject)
#
# colnames(dOutput)[1] = 'Subject'
#
# dOutput = dOutput[order(dOutput$roi,dOutput$Subject),]
#
# write.csv(dOutput,file = outputFile, row.names = F)
# inputFile = 'AllData.csv';
# outputFile = '../data/behav/VideoRating.csv';
# SubjKey = 'SubjKey.csv'
# ImmScore = 'dDemo.tsv'
#
# dKey = read.csv(SubjKey)
# colnames(dKey) = c('Subj','SubjNo')
#
# d0 = read.csv(inputFile)
#
# dDemo = read.csv(ImmScore,sep = '')
# colnames(dDemo)[1] = 'Subj'
#
# dOutput = right_join(dKey,d0) %>%
#   right_join(dDemo)
#
# dOutput$Group = ifelse(dOutput$ImmScore > median(dOutput$ImmScore),'Conservative','Liberal')
#
# dOutput = dplyr::select(dOutput,
#                  c('SubjNo','Issue','Video','ReverseCode_Issue','ReverseCode_Video','Agree','Credible','Change','ImmScore','Group'))
#
# colnames(dOutput)[1] = 'Subj'
#
# dOutput = dOutput[order(dOutput$Subj),]
#
# write.csv(dOutput,file = outputFile, row.names = F)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
dOutput = dplyr::select(dOutput,
-c('SubjNo'))
colnames(dOutput)[1] = 'Subj'
dOutput = dOutput[order(dOutput$Subj),]
write.csv(dOutput,file = outputFile, row.names = F, col.names = F)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
dOutput = dplyr::select(dOutput,
-c('SubjNo'))
View(dOutput)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
View(dOutput)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
dOutput = dplyr::select(dOutput,
-c('Subj'))
colnames(dOutput)[1] = 'Subj'
dOutput = dOutput[order(dOutput$Subj),]
write.csv(dOutput,file = outputFile, row.names = F, col.names = F)
rm(list=ls())
library(plyr)
library(dplyr)
library(tidyverse)
# inputFile = 'WB_regional.csv';
# outputFile = '../data/fmri/movie_data/wb_roi/WB_regional.csv';
# SubjKey = 'SubjKey.csv'
#
# dKey = read.csv(SubjKey)
# colnames(dKey) = c('Subject','SubjNo')
# d0 = read.csv(inputFile)
#
# dOutput = right_join(dKey,d0) %>%
#   select(-Subject)
#
# colnames(dOutput)[1] = 'Subject'
#
# dOutput = dOutput[order(dOutput$roi,dOutput$Subject),]
#
# write.csv(dOutput,file = outputFile, row.names = F)
# inputFile = 'AllData.csv';
# outputFile = '../data/behav/VideoRating.csv';
# SubjKey = 'SubjKey.csv'
# ImmScore = 'dDemo.tsv'
#
# dKey = read.csv(SubjKey)
# colnames(dKey) = c('Subj','SubjNo')
#
# d0 = read.csv(inputFile)
#
# dDemo = read.csv(ImmScore,sep = '')
# colnames(dDemo)[1] = 'Subj'
#
# dOutput = right_join(dKey,d0) %>%
#   right_join(dDemo)
#
# dOutput$Group = ifelse(dOutput$ImmScore > median(dOutput$ImmScore),'Conservative','Liberal')
#
# dOutput = dplyr::select(dOutput,
#                  c('SubjNo','Issue','Video','ReverseCode_Issue','ReverseCode_Video','Agree','Credible','Change','ImmScore','Group'))
#
# colnames(dOutput)[1] = 'Subj'
#
# dOutput = dOutput[order(dOutput$Subj),]
#
# write.csv(dOutput,file = outputFile, row.names = F)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
dOutput = dplyr::select(dOutput,
-c('Subj'))
colnames(dOutput)[1] = 'Subj'
dOutput = dOutput[order(dOutput$Subj),]
write.csv(dOutput,file = outputFile, row.names = F, header = F)
inputFile = 'DMPFC_VideoNeural.csv';
outputFile = '../data/fmri/roi_tc/DMPFC/DMPFC_VideoNeural.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile, header = F)
colnames(d0)[1] = 'Subj'
dOutput = right_join(dKey,d0)
dOutput = dplyr::select(dOutput,
-c('Subj'))
colnames(dOutput)[1] = 'Subj'
dOutput = dOutput[order(dOutput$Subj),]
write.csv(dOutput,file = outputFile, row.names = F, col.names = F)
rm(list=ls())
# Load packages
library(tidyr)
library(dplyr)
library(ggplot2)
library(lmerTest)
library(cowplot)
library(MASS)
library(sfsmisc)
library(Rarity)
# Script Specific Functions
asNumeric <- function(x) as.numeric(as.character(x))
factorsNumeric <- function(d) modifyList(d, lapply(d[, sapply(d, is.factor)],
asNumeric))
sem <-
function(x) {sd(x,na.rm = T) / sqrt(length(x))}
myPalette <- c("#4C72B0", "#C44E52")
# load data
AllData = read.csv("../../data/behav/AllData2.csv")
AllData$AgreeRecode = ifelse(AllData$Video_Party == 2,
AllData$Agree,
6 - AllData$Agree)
AllData$CredRecode = ifelse(AllData$Video_Party == 2,
AllData$Credible,
6 - AllData$Credible)
AllData$ChangeRecode = ifelse(AllData$Issue_Party == 2,
AllData$Change,
6 - AllData$Change)
AllData$Composite = (AllData$AgreeRecode + AllData$CredRecode + AllData$ChangeRecode) / 3
NeuralDiff = read.csv('../../data/roi_tc/DMPFC/DMPFC_VideoNeural.csv', header = F)
colnames(NeuralDiff) = c('Subj','Video','LibSim','ConSim','Lib_Con')
NeuralDiff$Con_Lib = -NeuralDiff$Lib_Con
AllData = full_join(AllData, NeuralDiff)
AllData$Subj = factor(AllData$Subj)
left = c(101,102,103,104,106,107,108,109,110,111,117,114,115,116,119,120,122,124,210)
AllData$Group = ifelse(AllData$Subj %in% left, 'Liberal','Conservative')
AllData$WithinBetween = ifelse(AllData$Subj %in% left, AllData$LibSim-AllData$ConSim, AllData$ConSim-AllData$LibSim)
SubjData = AllData %>%
group_by(Subj,Group) %>%
dplyr::summarise(ChangeRecode = mean(ChangeRecode))
GroupData = SubjData %>%
group_by(Group) %>%
dplyr::summarise(meanChangeRecode = mean(ChangeRecode), SE = sem(ChangeRecode))
t.test(ChangeRecode ~ Group, SubjData)
rm(list=ls())
# Load packages
library(tidyr)
library(dplyr)
library(ggplot2)
library(lmerTest)
library(cowplot)
library(MASS)
library(sfsmisc)
library(Rarity)
# Script Specific Functions
asNumeric <- function(x) as.numeric(as.character(x))
factorsNumeric <- function(d) modifyList(d, lapply(d[, sapply(d, is.factor)],
asNumeric))
sem <-
function(x) {sd(x,na.rm = T) / sqrt(length(x))}
myPalette <- c("#4C72B0", "#C44E52")
# load video ratings
AllData = read.csv("../../data/behav/VideoRating.csv")
AllData$AgreeRecode = ifelse(AllData$ReverseCode_Video == 2,
AllData$Agree,
6 - AllData$Agree)
AllData$CredRecode = ifelse(AllData$ReverseCode_Video == 2,
AllData$Credible,
6 - AllData$Credible)
AllData$ChangeRecode = ifelse(AllData$ReverseCode_Issue == 2,
AllData$Change,
6 - AllData$Change)
SubjData = AllData %>%
group_by(Subj,Group) %>%
dplyr::summarise(ChangeRecode = mean(ChangeRecode))
GroupData = SubjData %>%
group_by(Group) %>%
dplyr::summarise(meanChangeRecode = mean(ChangeRecode), SE = sem(ChangeRecode))
t.test(ChangeRecode ~ Group, SubjData)
inputFile = 'AllData.csv';
outputFile = '../data/behav/VideoRating.csv';
SubjKey = 'SubjKey.csv'
ImmScore = 'dDemo.tsv'
dKey = read.csv(SubjKey)
colnames(dKey) = c('Subj','SubjNo')
d0 = read.csv(inputFile)
View(d0)
dDemo = read.csv(ImmScore,sep = '')
colnames(dDemo)[1] = 'Subj'
View(dDemo)
dOutput = right_join(dKey,d0) %>%
right_join(dDemo)
View(dOutput)
